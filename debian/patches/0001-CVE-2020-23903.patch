From: Leonidas Da Silva Barbosa <leo.barbosa@canonical.com>
Date: Wed, 23 Feb 2022 10:33:17 -0300
Subject: CVE-2020-23903

Taken from speex/1.2~rc1.2-1.1ubuntu3:

 * SECURITY UPDATE: Divide by Zero
   - debian/patches/CVE-2020-23903.patch: guard against
     invalid channel numbers in src/wav_io.c.

Applied-Upstream: https://gitlab.xiph.org/xiph/speex/-/commit/870ff845b32f314aec0036641ffe18aba4916887
Forwarded: https://gitlab.xiph.org/xiph/speex/-/merge_requests/1
---
 src/wav_io.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/wav_io.c b/src/wav_io.c
index c2e2bc8..4d77cd7 100644
--- a/src/wav_io.c
+++ b/src/wav_io.c
@@ -108,7 +108,7 @@ int read_wav_header(FILE *file, int *rate, int *channels, int *format, spx_int32
    stmp = le_short(stmp);
    *channels = stmp;
 
-   if (stmp>2)
+   if (stmp>2 || stmp<1)
    {
       fprintf (stderr, "Only mono and (intensity) stereo supported\n");
       return -1;
